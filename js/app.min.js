const BACKGROUND_IMAGE="images/pp3.webp",IMAGE_QUALITY=.9,verbs=[{en:"AXE",fr:"HACHER"},{en:"CUT",fr:"COUPER"},{en:"NIX",fr:"RÉDUIRE"},{en:"SCRAP",fr:"SCRAPPER"},{en:"DUMP",fr:"JETTER"},{en:"SLASH",fr:"SLASHER"},{en:"FIX",fr:"RÉPARER"},{en:"STOP",fr:"STOPPER"},{en:"BUILD",fr:"CONSTRUIRE"},{en:"BOOST",fr:"BOOSTER"},{en:"CRUSH",fr:"ÉCRASER"},{en:"END",fr:"METTRE FIN À"},{en:"CONTROL",fr:"MAÎTRISER"},{en:"DEFUND",fr:"REMBOURSER"},{en:"REIN IN",fr:"FREINER"},{en:"FREEZE",fr:"GELER"},{en:"DRAIN",fr:"ASSÉCHER"},{en:"TACKLE",fr:"TACKLER"},{en:"UNLEASH",fr:"LIBÉRER"},{en:"UNLOCK",fr:"DÉBLOQUER"},{en:"DEFEND",fr:"DÉFENDRE"},{en:"REBUILD",fr:"RECONSTRUIRE"},{en:"IGNITE",fr:"ALLUMER"},{en:"EMPOWER",fr:"AUTONOMISER"},{en:"CHAMPION",fr:"CHAMPIONER"},{en:"EXPLOIT",fr:"EXPLOITER"},{en:"RESTORE",fr:"RESTAURER"},{en:"DISRUPT",fr:"PERTURBER"},{en:"YEET",fr:"YEETER"}],nouns=[{en:"THE TAX",fr:"LES IMPÔTS"},{en:"THE BUDGET",fr:"LE BUDGET"},{en:"MY MISERY",fr:"MA MISÈRE"},{en:"MY AGONY",fr:"MA SOUFFRANCE"},{en:"MY PAIN",fr:"MA DOULEUR"},{en:"MY ANGUISH",fr:"MON ANGOISSE"},{en:"MY DESPAIR",fr:"MON DÉSESPOIR"},{en:"MY SUFFERING",fr:"MA SOUFFRANCE"},{en:"MY ANXIETY",fr:"MON ANXIÉTÉ"},{en:"MY STRESS",fr:"MON STRESS"},{en:"THE CRIME",fr:"LE CRIME"},{en:"THE JOBS",fr:"LES JOBS"},{en:"THE HOUSES",fr:"LES MAISONS"},{en:"THE BORDERS",fr:"LES FRONTIÈRES"},{en:"THE COST OF LIVING",fr:"LE COÛT DE LA VIE"},{en:"THE HEALTH",fr:"LES SOINS DE SANTÉ"},{en:"THE EDUCATION",fr:"L'ÉDUCATION"},{en:"THE SCHOOLS",fr:"LES ECOLES"},{en:"THE CBC",fr:"RADIO CANADA"},{en:"THE QUEBEC",fr:"LE QUEBEC"},{en:"THE CITY MAYORS",fr:"LES MAIRES DES VILLES"},{en:"THE PUBLIC SECTOR",fr:"LE SECTEUR PUBLIC"},{en:"JUSTIN TRUDEAU",fr:"JUSTIN TRUDEAU"},{en:"THE LIBERALS",fr:"LES LIBÉRAUX"},{en:"THE BLOC",fr:"LE BLOC"},{en:"THE INFLATION",fr:"L'INFLATION"},{en:"THE SWAMP",fr:"LE MARÉCAGE"},{en:"THE RED TAPE",fr:"LA BUREAUCRATIE"},{en:"THE GAS PRICES",fr:"LES PRIX DU CARBURANT"},{en:"THE DEFICIT",fr:"LE DÉFICIT"},{en:"MY LEADERSHIP",fr:"MON LEADERSHIP"},{en:"MY SEAT",fr:"MON SIÈGE"},{en:"MY SECURITY CLEARANCE",fr:"HABILITATION DE SÉCURITÉ"},{en:"MY PARTY",fr:"MON PARTI"},{en:"MY LEADERSHIP",fr:"MON LEADERSHIP"},{en:"MY SEAT",fr:"MON SIÈGE"},{en:"MY SECURITY CLEARANCE",fr:"HABILITATION DE SÉCURITÉ"},{en:"MY PARTY",fr:"MON PARTI"},{en:"THE WASTE",fr:"LE GASPILLAGE"},{en:"THE SUITS",fr:"LES COSTUMES"},{en:"THE SYSTEM",fr:"LE SYSTÈME"},{en:"THE ECONOMY",fr:"L'ÉCONOMIE"},{en:"THE ESTABLISHMENT",fr:"L'ESTABLISHMENT"},{en:"THE STATUS QUO",fr:"LE STATU QUO"},{en:"THE MIDDLE CLASS",fr:"LA CLASSE MOYENNE"},{en:"THE SMALL BUSINESSES",fr:"LES PETITES ENTREPRISES"},{en:"THE FUTURE GENERATIONS",fr:"LES GÉNÉRATIONS FUTURES"},{en:"THE BUREAUCRACY",fr:"LA BUREAUCRATIE"},{en:"THE BIG GOVERNMENT",fr:"LE GOUVERNEMENT TENTACULAIRE"},{en:"THE FAMILY VALUES",fr:"LES VALEURS FAMILIALES"},{en:"THE CANADIAN DREAM",fr:"LE RÊVE CANADIEN"},{en:"THE BLOC MAJORITY",fr:"LE BLOC MAJORITAIRE"},{en:"THE DEMOCRACY",fr:"LA DÉMOCRATIE"},{en:"THE REGULATIONS",fr:"LES RÈGLEMENTS"},{en:"THE DEEP STATE",fr:"L'ÉTAT PROFOND"},{en:"THE POLITICAL CORRECTNESS",fr:"LE POLITIQUEMENT CORRECT"},{en:"THE WORKING CLASS",fr:"LA CLASSE OUVRIÈRE"},{en:"THE ENVIRONMENT",fr:"L'ENVIRONNEMENT"},{en:"THE TREES",fr:"LES ARBRES"},{en:"THE SALES TAX",fr:"LA TAXE DE VENTE"},{en:"SNEAKY CARNEY",fr:"CARNEY SOURDIN"},{en:"THE POLICE",fr:"LA POLICE"},{en:"THE MEDIA",fr:"LES MÉDIAS"},{en:"THE ELITE",fr:"L'ÉLITE"},{en:"THE NATION",fr:"LA NATION"},{en:"THE PEOPLE",fr:"LE PEUPLE"},{en:"THE FUTURE",fr:"L'AVENIR"},{en:"THE COUNTRY",fr:"LE PAYS"},{en:"THE WORLD",fr:"LE MONDE"},{en:"THE PLANET",fr:"LA PLANÈTE"},{en:"THE UNIVERSE",fr:"L'UNIVERS"},{en:"THE GALAXY",fr:"LA GALAXIE"},{en:"THE COSMOS",fr:"LE COSMOS"},{en:"THE MULTIVERSE",fr:"LE MULTIVERS"},{en:"THE 51ST STATE",fr:"LE 51e ÉTAT"}];let lastVerbIndex,lastNounIndex,isFirstGeneration=!0;function generateSlogan(){let e,n,t=0;if(isFirstGeneration)e=Math.floor(Math.random()*verbs.length),n=nouns.findIndex((e=>"MY MISERY"===e.en)),-1===n&&(n=2),isFirstGeneration=!1;else do{if(e=Math.floor(Math.random()*verbs.length),n=Math.floor(Math.random()*nouns.length),t++,t>=10)break}while(e===lastVerbIndex||n===lastNounIndex);lastVerbIndex=e,lastNounIndex=n;const r=verbs[e],E=nouns[n];return{en:`${r.en} ${E.en}`,fr:`${r.fr} ${E.fr}`}}function createSharingImage(e,n){return new Promise((t=>{const r=new Image;r.onload=function(){const E=r.naturalWidth,o=r.naturalHeight,a=document.createElement("canvas");a.width=E,a.height=o;a.getContext("2d").drawImage(r,0,0);const i=createSVGContent(a.toDataURL("image/webp"),calculateTextSettings(e,n,E,o),E,o,e,n),f=new Blob([i],{type:"image/svg+xml"}),S=URL.createObjectURL(f);t({url:S,svgContent:i})},r.onerror=function(){console.error("Failed to load image:",BACKGROUND_IMAGE),t({error:!0,message:"Failed to load background image"})},r.src=BACKGROUND_IMAGE}))}function calculateTextSettings(e,n,t,r){const E=Math.round(.87*r),o=e.length,a=n.length,i=.029*t;return{enY:E-30,frY:E+30,enSize:Math.min(Math.max(i*(25/Math.max(o,10)),14),50),frSize:Math.min(Math.max(i*(25/Math.max(a,10)),12),40)}}function createSVGContent(e,n,t,r,E,o){return`\n    <svg xmlns="http://www.w3.org/2000/svg" \n        width="100%" \n        height="auto" \n        viewBox="0 0 ${t} ${r}"\n        preserveAspectRatio="xMidYMid meet">\n        <defs>\n            <style>\n                .slogan-text {\n                    font-family: Arial, sans-serif;\n                    font-weight: bold;\n                    fill: white;\n                    text-anchor: middle;\n                    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n                }\n            </style>\n        </defs>\n        \n        \x3c!-- Background image with embedded data URL --\x3e\n        <image href="${e}" width="100%" height="100%" preserveAspectRatio="xMidYMid meet" />\n        \n        \x3c!-- English slogan --\x3e\n        <text class="slogan-text" x="${t/2}" y="${n.enY}" font-size="${n.enSize}">\n            ${E}\n        </text>\n        \n        \x3c!-- French slogan --\x3e\n        <text class="slogan-text" x="${t/2}" y="${n.frY}" font-size="${n.frSize}">\n            ${o}\n        </text>\n    </svg>`}function updateSlogan(){const e=generateSlogan(),n=document.getElementById("podium-container");n.innerHTML='<div class="loading">Generating slogan...</div>',createSharingImage(e.en,e.fr).then((t=>{const r=document.createElement("img");r.src=t.url,r.alt=`Campaign slogan: ${e.en} / ${e.fr}`,r.className="fade-in",r.dataset.svgContent=t.svgContent,n.innerHTML="",n.appendChild(r)})).catch((t=>{console.error("Error creating slogan image:",t),n.innerHTML=`\n                <div class="error-message">\n                    <p>Error generating image</p>\n                    <p>English: ${e.en}</p>\n                    <p>French: ${e.fr}</p>\n                </div>`}))}function processImage(e,n){if(!e)return console.error("No SVG content found"),void n(null,null,!0);const t=new Image;t.onload=function(){const r=document.createElement("canvas"),E=r.getContext("2d");r.width=t.naturalWidth,r.height=t.naturalHeight,E.drawImage(t,0,0);const o=extractTextFromSVG(e);renderTextOnCanvas(E,r.width,o),n(r,e)},t.onerror=function(){console.error("Failed to load original image"),n(null,e,!0)},t.src=BACKGROUND_IMAGE}function extractTextFromSVG(e){const n=(new DOMParser).parseFromString(e,"image/svg+xml").querySelectorAll("text");let t={en:{text:"",y:0,fontSize:0},fr:{text:"",y:0,fontSize:0}};return n.forEach(((e,n)=>{const r=e.textContent.trim(),E=parseFloat(e.getAttribute("y")),o=parseFloat(e.getAttribute("font-size"));0===n?t.en={text:r,y:E,fontSize:o}:t.fr={text:r,y:E,fontSize:o}})),t}function renderTextOnCanvas(e,n,t){e.fillStyle="white",e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0, 0, 0, 0.7)",e.shadowBlur=4,e.shadowOffsetX=2,e.shadowOffsetY=2,e.font=`bold ${t.en.fontSize}px Arial, sans-serif`,e.fillText(t.en.text,n/2,t.en.y-10),e.font=`bold ${t.fr.fontSize}px Arial, sans-serif`,e.fillText(t.fr.text,n/2,t.fr.y)}function exportCanvas(e,n,t){const{asDownload:r=!1,filename:E="pp-slogan"}=t||{};try{exportCanvasAs(e,"jpeg",`${E}.jpg`,r)}catch(t){console.error("Error creating WebP:",t);try{exportCanvasAs(e,"png",`${E}.png`,r)}catch(e){console.error("Error creating PNG:",e),n&&exportSVG(n,`${E}.svg`,r)}}}function exportCanvasAs(e,n,t,r){if(r){const r=e.toDataURL(`image/${n}`,.9),E=document.createElement("a");E.href=r,E.download=t,document.body.appendChild(E),E.click(),document.body.removeChild(E)}else e.toBlob((e=>{const n=URL.createObjectURL(e);window.open(n,"_blank"),setTimeout((()=>URL.revokeObjectURL(n)),6e4)}),`image/${n}`,.9)}function exportSVG(e,n,t){const r=new Blob([e],{type:"image/svg+xml"}),E=URL.createObjectURL(r);if(t){const e=document.createElement("a");e.href=E,e.download=n,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(E)}else window.open(E,"_blank"),setTimeout((()=>URL.revokeObjectURL(E)),6e4)}function downloadShareableImage(){const e=document.querySelector("#podium-container img");e&&e.dataset.svgContent?processImage(e.dataset.svgContent,((e,n,t)=>{if(t)return alert("Failed to load background image. Falling back to SVG."),void exportSVG(n,"campaign-slogan.svg",!0);exportCanvas(e,n,{asDownload:!0})})):console.error("No image or SVG content found")}function shareInNewTab(){const e=document.querySelector("#podium-container img");e&&e.dataset.svgContent?processImage(e.dataset.svgContent,((e,n,t)=>{t?exportSVG(n,null,!1):exportCanvas(e,n,{asDownload:!1})})):console.error("No image or SVG content found")}function downloadAsSVG(e){const n=new Blob([e],{type:"image/svg+xml"}),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.download="campaign-slogan.svg",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}function addAnimationStyles(){if(!document.querySelector("style#slogan-animations")){const e=document.createElement("style");e.id="slogan-animations",e.textContent="\n            @keyframes fadeIn {\n                from { opacity: 0; transform: translateY(10px); }\n                to { opacity: 1; transform: translateY(0); }\n            }\n            .fade-in {\n                animation: fadeIn 0.5s ease-in-out;\n            }\n            .loading {\n                font-family: Arial, sans-serif;\n                text-align: center;\n                padding: 20px;\n                color: #333;\n            }\n            .error-message {\n                font-family: Arial, sans-serif;\n                text-align: center;\n                padding: 20px;\n                color: #721c24;\n                background-color: #f8d7da;\n                border: 1px solid #f5c6cb;\n                border-radius: 4px;\n            }\n        ",document.head.appendChild(e)}}document.addEventListener("DOMContentLoaded",(()=>{addAnimationStyles(),updateSlogan(),document.getElementById("generateButton").addEventListener("click",updateSlogan),document.getElementById("downloadButton").addEventListener("click",downloadShareableImage),document.getElementById("shareButton").addEventListener("click",shareInNewTab),document.addEventListener("keydown",(function(e){"Space"===e.code&&(updateSlogan(),e.preventDefault())}))}));